<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Datenbanken 1 - Übungsblatt 6</title>
    <link rel="stylesheet" href="exercises.css">
    <link href="../lib/fontawesome.all.min.css" rel="stylesheet">
    <link href="../src/erd.css" rel="stylesheet">
    <link rel="stylesheet" href="../lib/joint.min.css" />
</head>
<body>
    <header>
        <div>
        <div>
            <b>Datenbanken 1 - WS 2019/20</b><br>
            Dr.-Ing. Johannes Schildgen<br>
            johannes.schildgen@h-da.de<br>
            <b>Übungsblatt 6 vom 20.01.2020, 27./28.01.2020</b>
        </div>
        <div><img src="../img/hda.png" style="border:0; height:80px"></div>
    </div>
    <hr>
    </header>
<section style="padding-top: 2.5cm">
        <h1>Aufgabe 0: SQL (Bonusaufgabe, 10P)</h1>
        <p>Abgabe-Deadline: 20.01.2020 12:00 im Moodle</p>
        <p>Im LOTS-Tool der Uni Leipzig (<a href="https://lots.uni-leipzig.de/sql-training" target="_blank">https://lots.uni-leipzig.de/sql-training/)</a> können Sie SQL-Anfragen auf einer Bibliotheksdatenbank ausführen. Dort sind Bücher, Autoren und Verläge gespeichert. Bücher können mit Schlagworten versehen werden. Formulieren Sie die folgende Anfrage mittels SQL. <b>In dieser Aufgabe dürfen Sie keine Subanfragen, CTEs, IN, oder EXISTS verwenden.</b> Für jede Subanfrage etc. gibt es einen Punkt Abzug.</p>

        <p><b>Welche Bücher vom Verlag &quot;Springer&quot; (2P) besitzen das Schlagwort &quot;Künstliche Intelligenz&quot;? (3P) Geben Sie die ISBN, den Titel und die Anzahl der Autoren aus (5P).</b> In Klammern stehen die Teilpunkte, die Sie bekommen, wenn Sie Aufgabe nur teilweise lösen.</p>
</section>
<section>
    <h1>Aufgabe 1: Rechtemanagement, Transaktionen, JDBC (10P)</h1>
    <p>Abgabe-Deadline: 20.01.2019 12:00 im Moodle</p>
    <p>Welche der folgenden Aussagen sind wahr? Jede richtige Antwort gibt 1 Punkt, falsche Antworten geben keine Punktabzüge.</p>
    <table border="0" style="width: 100%; margin-top: -5mm;">
    <tr>
        <td style="width:10mm">&nbsp;</td>
        <td>&nbsp;</td>
        <td style="text-align: center; width:15mm">Richtig</td>
        <td style="text-align: center; width:15mm">Falsch</td>
    </tr>
    <tr>
        <td>1.</td><td>Wenn ich GRANT rolle TO benutzer ausführe, hat der angegebene Benutzer alle Berechtigungen der spezifizierten Rolle.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>2.</td><td>Mit REVOKE ... RESTRICT verbiete ich, ein Recht weiterzugeben.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>3.</td><td>Wenn eine Transaktion Daten schreibt und sie diese selbst wieder liest, nennt man dies ein Dirty Read.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>4.</td><td>Es laufen zwei Transaktionen parallel. Eine schreibt in x und die andere liest x gleichzeitig. Hier kann ein Lost Update auftreten.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>5.</td><td>Das Phantomproblem kann auftreten, wenn zwischen zwei Leseoperationen eine andere Transaktion Datensätze löscht.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>6.</td><td>Es gibt einen Zyklus im Serialisierbarkeitsgraph der folgenden Historie: w<sub>1</sub>(x), w<sub>2</sub>(x), r<sub>2</sub>(y), r<sub>1</sub>(y), w<sub>3</sub>(y), c<sub>1</sub>, c<sub>2</sub>, c<sub>3</sub></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>7.</td><td>Wird bei der Historie aus der vorherigen Frage das SW-Sperrverfahren eingesetzt, muss TA<sub>2</sub> warten, bevor sie in x schreiben darf.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>8.</td><td>Die Redo-Info im Transaktionslog wird verwendet, um noch nicht auf die Festplatte geschriebene Aktionen von Gewinner-Transaktionen auszuführen.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>9.</td><td>In JDBC enthält ein PreparedStatement Fragezeichen als Platzhalter, die vor der Query-Ausführung mit Werten belegt werden können.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    <tr>
        <td>10.</td><td>In JDBC liefert executeQuery einen Array zurück, der die Ergebnisse der übergebenen Anfrage beinhaltet.</td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
        <td style="text-align: center"><i class="far fa-square"></i></td>
    </tr>
    </table>
            
    </section>

    <section style="page-break-inside:avoid; padding-top: 3cm">
    <h1>Aufgabe 2: Anwendungsentwicklung mit JDBC</h1>
    <p>Auf <a href="https://data.deutschebahn.com/dataset/data-stationsdaten" target="_blank">https://data.deutschebahn.com/dataset/data-stationsdaten</a> finden Sie Datensätze mit deutschen Bahnhöfen.</p>
    <ol>
        <li>Laden Sie sich einen Datensatz im CSV-Format herunter.</li>
        <li>Betrachten Sie die Datei in einem Texteditor, welche Spalten gibt es?</li>
        <li>Erstellen Sie in Ihrer PostgreSQL-Datenbank eine Tabelle &quot;bahnhoefe&quot; mit den passenden Spalten und wählen Sie sinnvolle Datentypen und Primärschlüssel.</li>
        <li>Benutzen Sie die Import-Funktion von DBeaver, um die CSV-Datei in Ihre Tabelle zu importieren (Rechtsklick auf die Tabelle - Daten importieren).</li>
        <li>Erstellen Sie folgende Views:
            <ol type="a">
                <li>Eine View &quot;hbf&quot; mit dem Spalten &quot;bhfnr&quot;, &quot;bundesland&quot;, &quot;station&quot; und &quot;kategorie&quot;, die alle Bahnhöfe enthält, die auf &quot;Hbf&quot; oder &quot;Hauptbahnhof&quot; enden. Die Kategorie ist lediglich eine Umbenennung der Spalte Kat. Vst.</li>
                <li>Eine View &quot;grosser_hbf&quot;, der auf der Sicht &quot;hbf&quot; basiert, aber nur die Bahnhöfe der Kategorie 1 enthält. Schreiben Sie am Ende des <code>CREATE VIEW</code>-Kommandos: <code>WITH LOCAL CHECK OPTION</code>. Dadurch wird beim Einfügen in die View das WHERE-Prädikat überprüft.</li>
            </ol>
        </li>
        <li>Formulieren Sie nun folgende Anfragen auf den Views:
                <ol type="a">
                    <li>Finden Sie den Darmstädter Hauptbahnhof</li>
                    <li>Fügen Sie in die hbf-Sicht einen neuen Bahnhof ein: &quot;Teststadt Nord&quot; in Hessen mit der ID 9999 und Kategorie 5.</li>
                    <li>Finden Sie mit einer SELECT-Anfrage auf der hbf-Sicht den neu eingefügten Bahnhof?</li>
                    <li>Löschen Sie den Bahnhof 9999 wieder aus der hbf-Sicht</li>
                    <li>Versuchen Sie das INSERT aus b) nun auf der grosser_hbf-Sicht</li>
                    <li>Passen Sie die Bahnhofskategorie so an, dass das INSERT auf der grosser_hbf-Sicht funktioniert: <code>WITH CASCADED CHECK OPTION</code></li>
                    <li>Finden Sie mit einer SELECT-Abfrage auf der grosser_hbf-Sicht den neu eingefügten Bahnhof?</li>
                    <li>Droppen Sie die grosser_hbf-Sicht und erstellen Sie sie erneut, jedoch so, dass wirklich nur Bahnhöfe in diese Sicht eingefügt werden können, die auch in der View sichtbar sind.</li>
                </ol>
        </li>
        <li>Erstellen Sie eine materialisierte Sicht &quot;Bahnhof_Statistik&quot;, die zu jedem Bundesland die Anzahl der Bahnhöfe zeigt. Wie viele Bahnhöfe zeigt diese Sicht in Hessen an? Löschen Sie Ihren Bahnhof 9999 und schauen Sie wieder in die materialiserte Sicht. Führen Sie ein <code>REFRESH</code> aus.</li>
        <li>Stellen Sie abschließend noch folgende Anfragen auf der Tabelle &quot;bahnhoefe&quot;:
                <ol type="a">
                    <li>Geben Sie alle Bundesländer aus (keine Duplikate).</li>
                    <li>In welchen Städten gibt es mehr als 10 Bahnhöfe?</li>
                    <li>Welche Bahnhöfe haben die gleiche Kategorie (Kat. Vst.) wie &quot;Ulm Hbf&quot;?</li>
                    <li>Geben Sie zu jedem Bundesland aus, wie viele Bahnhöfe die dort befindlichen Städte im Durchschnitt besitzen.</li>
                </ol>
            </li>
    </ol>
    
  </section>

<script src="../lib/jquery.js"></script>
<script src="../lib/lodash.js"></script>
<script src="../lib/backbone.js"></script>
<script src="../lib/joint.min.js"></script>
<script type="text/javascript">
Reveal = document;
Reveal.registerPlugin = function(pluginname, plugin) {
    plugin.init()
};
Reveal.addEventListener = function(event, f) {
    if(event == 'ready') {
        f();
    }
}
</script>
<script type="text/javascript" src="../src/erd.js"></script>

</body>
</html>